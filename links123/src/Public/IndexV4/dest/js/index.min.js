!function(){for(var a,b=function(){},c=["assert","clear","count","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"],d=c.length,e=window.console=window.console||{};d--;)a=c[d],e[a]||(e[a]=b)}();var APP=$CONFIG.APP,URL=$CONFIG.URL,PUBLIC=$CONFIG.PUBLIC;$(function(){ZhiDaLan.Init(),Theme.Init(),User.Init(),THL.Init(),Zld.Init(),HelpMouse.Init(),Ted.Init()});var Theme={Init:function(){var a=this;a.themes=["purple","black","green"],a.initPanel(),a.panel=$(".screen-theme"),a.panel.on("click","#J_skin_pics a",function(){var b=$(this).attr("data-theme");a.setTheme(b)}),a.timer=null,$("#K_change_skin_btn").on("mouseenter",function(){$(".skin-list").fadeIn(150)}).on("mouseleave",".skin-list",function(){clearTimeout(a.timer),a.timer=null,a.timer=setTimeout(function(){$(".skin-list").hide()},500)}).on("mouseover",".skin-list",function(){$(this).is(":hidden")||(clearTimeout(a.timer),a.timer=null)}),a.loadBigBackground()},loadBigBackground:function(a){var b=a||$CONFIG.theme,c=document.createElement("img");c.src=PUBLIC+"/IndexV4/dest/imgs/"+b+"/bg.jpg",c.onload=function(){$("body").css("background-image","url("+c.src+")")}},initPanel:function(){var a,b=this,c=b.themes,d="";$.each(c,function(b,c){a=PUBLIC+"/IndexV4/dest/imgs/theme-"+c+"/preview.jpg",d+='<a data-theme="theme-'+c+'"><img src="'+a+'" /></a>'}),$("#J_skin_pics").html(d)},setTheme:function(a){var b=this;b.oldTheme=$(".theme-css-link");var c=document.getElementsByTagName("head")[0],d=b.css=document.createElement("link");d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("href",PUBLIC+"/IndexV4/dest/css/"+a+".css"),c.appendChild(d),b.change("theme",a),b.loadBigBackground(a)},change:function(a,b){var c=this,d=URL+"/updateThemeV4";c.css.className="theme-css-link",data={themeId:b},$.post(d,data)}},ZhiDaLan={Init:function(){$(document).on("click",function(){$("#direct_text").val($("#direct_text").attr("txt")).addClass("ipton")}),$("#direct_text").on("mouseout",function(){var a=$.trim($("#direct_text").val());(""==a||a==$("#direct_text").attr("txt"))&&($("#search_text").select(),$("#direct_text").addClass("ipton"))}),$("#direct_text").on("click",function(){var a=$.trim($("#direct_text").val());return a==$("#direct_text").attr("txt")&&$("#direct_text").val("").removeClass("ipton"),!1}).on("blur",function(){$("#direct_text").addClass("ipton")}),$(".J_direct_submit").on("click",function(){return $("#frm_drct").trigger("submit"),$("#direct_text")[0].focus(),!1}),$("#frm_drct").on("submit",function(){var a=$.trim($("#direct_text").val());return""==a||a==$("#direct_text").attr("txt")?!1:($("#direct_text").select(),void 0)})}},THL={conf:{topnm:34,topex:64},Init:function(){var a=this;$.cookies.set("keyword",""),$("#search_text").val("").select(),$(".thl").mouseover(function(){$("#J_thl_div").show(),$("#search_text").select()}),$(".J_thl_area").mouseleave(function(){$("#J_thl_div").hide()}),$(".J_thlz a").click(function(){return $(this).addClass("on").siblings("a").removeClass("on"),$("#btn_search").trigger("click"),!1}),$("#J_thl_div a").click(function(){$(this).addClass("on").siblings("a").removeClass("on");var a=$(this).index();return $(".J_thlz:eq("+a+")").show().siblings(".J_thlz").hide(),$(".J_thlz a").removeClass("on"),$(".J_thlz:eq("+a+")").find("a:first").addClass("on"),!1}),$("#search_text").blur(function(){""==$(this).val()&&$.cookies.set("keyword","")}),$("#search_text").keyup(function(){$("#J_thl_div").show(),a.setpos()}),$("#search_text").on("click",function(){if($.cookies.get("keyword"))$(this).data("key","");else{var a=$.trim($("#search_text").val());""!=a&&($(this).data("key",a),$(this).val(a))}}),$("#search_text").on("webkitspeechchange",function(){var b=$(this).data("key");if(b&&""!=b){var c=$(this).val();0==c.indexOf(b)&&($(this).val(c.replace(b,b+" ")),$(this).data("key",""))}a.setpos()}),$(document).mouseup(function(){if("INPUT"!=document.activeElement.tagName&&"TEXTAREA"!=document.activeElement.tagName&&"IFRAME"!=document.activeElement.tagName&&"direct_text"!=document.activeElement.id&&"search_text"!=document.activeElement.id&&"search_text"!=document.activeElement.id){var a="";window.getSelection?a=window.getSelection():document.getSelection?a=document.getSelection():document.selection&&(a=document.selection.createRange().text),""==a&&$("#search_text").select(),$.cookies.get("keyword")&&$("#search_text").select()}}),$("#btn_search").click(function(){$("#search_text").select();var b=$.trim($("#search_text").val());$.cookies.set("keyword",b),b=b.replace("http://",""),b=encodeURIComponent(b);var c=$(".J_thlz a.on").attr("url").replace("keyword",b),d=$(".J_thlz a.on").attr("tid");return a.go(c,d,b),!1})},go:function(a,b,c){if("4"==b||"26"==b||"40"==b||"58"==b||"110"==b||"117"==b)$.post(URL+"/thl_count",{tid:b},function(){}),window.open("http://"+a);else if("10"==b||"20"==b)window.open(a);else{a=APP+"Thl/index";var d=$("#searchForm");$("#J_thl").val($("#J_thl_div a.on").text()),$("#J_tid").val(b),$("#J_q").val(c),d.attr("action",a),d.attr("target","_blank"),d.submit(),d.attr("action",""),d.attr("target",""),$("#search_text").select()}},setpos:function(){var a,b=this;""!=$("#search_text").val()?(a=b.conf.topex,$("#J_thl_div").css("top",a).removeClass("cate-in")):(a=b.conf.topnm,$("#J_thl_div").hide(),$("#J_thl_div").css("top",a).addClass("cate-in"))}};$(document).on("click",'[href="#"],.disabled',function(a){a.preventDefault()}),$(document).on("mousemove",".ui-widget-overlay",function(a){a.stopPropagation()}),$.fn.userMsg=function(a){"hide"==a?this.hide():this.show().find("div").html(a)};var User={Init:function(){var a=this,b=a.r_Dialog=$(".user-reg-dialog"),c=a.l_Dialog=$(".user-log-dialog");a.ok_dialog=$(".user-reg-ok-dialog"),a.msgs=$(".user-dialog").find(".msg"),a.r_msgs=b.find(".msg"),a.r_msg_username=b.find(".msg-username"),a.r_msg_password=b.find(".msg-password"),a.r_msg_email=b.find(".msg-email"),a.r_msg_vcode=b.find(".msg-vcode"),a.l_msgs=c.find(".msg"),a.l_msg_username=c.find(".msg-username"),a.l_msg_password=c.find(".msg-password"),a.r_Dialog.dialog({autoOpen:!1,modal:!0,resizable:!1,width:460,show:{effect:"clip",duration:150},hide:{effect:"clip",duration:150},open:function(){setTimeout(function(){a.r_Dialog.find('input[name="username"]').select()},20)}}),a.l_Dialog.dialog({autoOpen:!1,modal:!0,resizable:!1,width:460,show:{effect:"clip",duration:200},hide:{effect:"clip",duration:200},open:function(){setTimeout(function(){a.l_Dialog.find('input[name="username"]').select()},20)}}),a.ok_dialog.dialog({autoOpen:!1,modal:!0,resizable:!1,width:340,show:{effect:"clip",duration:150},hide:{effect:"clip",duration:150},open:function(){setTimeout(function(){window.location.href=APP+"Members/Index/"},3e3)}}),a.ok_dialog.on("click",".close-btn",function(){window.location.href=APP+"Members/Index/"}),$(".J_SignUp").on("click",function(){return a.Reg(),!1}),$(".J_SignIn").on("click",function(){return a.Login(),!1}),$(document).on("click",".J_VerifyImg",function(){$(this).attr("src",APP+"Verify?"+ +new Date)}),a.l_Dialog.on("click",".remember",function(){var a=$(this).hasClass("checked");a?$(this).removeClass("checked"):$(this).addClass("checked")}),$(document).on("mouseenter",'input[name="username"], input[name="password"], input[name="email"], input[name="vcode"]',function(){$(this).select()}).on("mousemove",'#J_Reg input[name="username"], input[name="password"], input[name="email"], input[name="vcode"]',function(){return!1}).on("keyup",'input[name="username"], input[name="password"], input[name="email"], input[name="vcode"]',function(){var b=$(this).attr("name");a["r_msg_"+b]&&a["r_msg_"+b].userMsg("hide"),a["l_msg_"+b]&&a["l_msg_"+b].userMsg("hide"),a["f_msg_"+b]&&a["f_msg_"+b].userMsg("hide")})},CheckLogin:function(){var a=this;return $CONFIG.IsLogin?(a.Login("请先登录"),!1):!0},Reg:function(){var a=this,b=a.r_Dialog;b.find("input").placeholder(),b.find('input[name="username"]').val(""),b.find('input[name="password"]').val(""),b.find('input[name="email"]').val(""),b.find('input[name="vcode"]').val(""),b.find(".msg").hide().find("div").html(""),b.dialog({autoOpen:!0,modal:!0,resizable:!1,open:function(){setTimeout(function(){b.find('input[name="username"]').select()},20)}}),b.find(".close-btn").on("click",function(){return b.dialog("close"),!1}),b.find('input[name="vcode"]').on("keydown",function(a){return 13==a.keyCode?(b.find(".submit-btn").trigger("click"),!1):void 0});var c=!1;b.find(".submit-btn").on("click",function(){if(c)return!1;var d=b.find('input[name="username"]'),e=b.find('input[name="password"]'),f=b.find('input[name="email"]'),g=b.find('input[name="vcode"]'),h=d.val(),i=e.val(),j=f.val(),k=g.val();if(!h||h==d.attr("placeholder"))return a.r_msg_username.userMsg("昵称不能为空"),d[0].focus(),!1;if(!/^[_a-z0-9-]+(\.[_a-z0-9-]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*$/.test(j))return a.r_msg_email.userMsg("email格式不正确"),f[0].focus(),!1;if(!i)return a.r_msg_password.userMsg("密码不能为空"),e[0].focus(),!1;if(!k)return a.r_msg_vcode.userMsg("验证不能为空"),g[0].focus(),!1;c=!0;var l={nickname:h,email:j,password:i,verify:k};return $.post(APP+"Members/Register/saveReg",l,function(d){if(d.indexOf("regOK")>=0)b.dialog("close"),a.ok_dialog.dialog("open");else{if(c=!1,d.search(/用户名/)>=0)return a.r_msg_username.userMsg(d),!1;if(d.search(/密码/)>=0)return a.r_msg_password.userMsg(d),!1;if(d.search(/email/i)>=0)return a.r_msg_email.userMsg(d),!1;if(d.search(/验证码/)>=0)return a.r_msg_vcode.userMsg(d),!1;a.r_msg_username.userMsg(d)}c=!1}),!1})},Login:function(msg){var self=this,obj=self.l_Dialog;obj.find('input[name="username"]').val(""),obj.find('input[name="password"]').val(""),obj.find(".msg").hide().find("div").html(""),obj.dialog("open"),obj.find(".close-btn").on("click",function(){return obj.dialog("close"),!1}),obj.find(".forget_pass").on("click",function(){obj.dialog("close"),self.FindPass()}),obj.find('input[name="password"]').on("keydown",function(a){return 13==a.keyCode?(obj.find(".submit-btn").trigger("click"),!1):void 0}),obj.find(".submit-btn").on("click",function(){var objusername=obj.find('input[name="username"]'),objpassword=obj.find('input[name="password"]'),username=objusername.val(),password=objpassword.val(),verify="",auto_login=obj.find(".remember").hasClass("checked");if(!username||username==objusername.attr("placeholder"))return self.l_msg_username.userMsg("用户名不能为空"),objusername[0].focus(),!1;if(!password)return self.l_msg_password.userMsg("密码不能为空"),objpassword[0].focus(),!1;var data={username:username,password:password,auto_login:auto_login?1:0};return $.post(APP+"Members/Login/checkLogin",data,function(data){var resp=eval("("+data+")");switch(console.log(resp),resp.code){case 200:window.opener&&document.referrer&&(window.opener.location.href=document.referrer),window.location.href=APP+"Index/indexV4.html";break;case 403:$(objusername[0]).val(""),$(objpassword[0]).val(""),self.l_msg_username.html(resp.content);break;case 501:self.l_msg_username.html(resp.content);break;case 502:self.l_msg_username.html(resp.content);break;case 503:self.l_msg_username.html(resp.content);break;case 504:self.l_msg_username.html(resp.content);break;case 505:break;case 506:self.l_msg_username.html(resp.content)}}),!1})},FindPass:function(){if(self.f_Dialog){var a=self.f_Dialog;a.find('input[name="email"]').val(""),a.find('input[name="vcode"]').val(""),a.dialog("open")}else{var a=self.f_Dialog=$(".user-find-password-dialog");a.dialog({autoOpen:!0,width:390,modal:!0,resizable:!1,open:function(){setTimeout(function(){a.find('input[name="email"]').select()},20)}}),self.f_msg_email=self.f_Dialog.find(".msg-email"),self.f_msg_vcode=self.f_Dialog.find(".msg-vcode"),a.find(".close-btn").on("click",function(){return a.dialog("close"),!1}),a.find('input[name="vcode"]').on("keydown",function(b){return 13==b.keyCode?(a.find(".submit-btn").trigger("click"),!1):void 0}),$(document).on("mouseenter",'input[name="email"], input[name="vcode"]',function(){$(this).select()}),a.find(".submit-btn").on("click",function(){var b=a.find('input[name="email"]'),c=a.find('input[name="vcode"]'),d=b.val(),e=c.val();if(!d)return self.f_msg_email.userMsg("请输入邮箱"),b[0].focus(),!1;var f=d.match(/^([a-zA-Z0-9_\.\-])+\@(([a-zA-Z0-9\-])+\.)+([a-zA-Z0-9]{2,4})+$/);return null==f?(self.f_msg_email.userMsg("请正确输入邮箱"),b[0].focus(),!1):e?($.post(APP+"Members/Login/missPwd",{email:d,verify:e},function(a){if(a.indexOf("sendOK")>=0){var b=a.split("|");alert("请进入您的账户邮箱获取新密码"),window.open("http://"+b[1])}else alert(a)}),void 0):(self.f_msg_vcode.userMsg("验证码不能为空"),c[0].focus(),!1)})}}},Zld={IsSortable:!1,Resize:function(){var a=$("#J_ZldList"),b=a.width(),c=a.find("li:not(.add)");c.css("width","auto");var d=0,e=null,f=null;if($.each(c,function(a,c){d+=$(c).width()+4,!e&&d>b&&(e=a,f=d-$(c).width()-4)}),!(b>=d))if(b-f>40){var g=c.eq(e).width()+4-(b-f);g=~~Math.ceil(g/(e+1)/2);var h=c.filter(":lt("+(e+1)+")");$.each(h,function(a,b){$(b).width();var c=$(b).find(".nm"),d=c.css("padding-left"),e=c.css("padding-right");c.css({"padding-left":parseInt(d)-g+"px","padding-right":parseInt(e)-g+"px"})})}else if(40>=b-f&&b-f>10){var g=b-f+4;g=~~Math.floor(g/(e-1)/2);var h=c.filter(":lt("+e+")");$.each(h,function(a,b){$(b).width();var c=$(b).find(".nm"),d=c.css("padding-left"),e=c.css("padding-right");c.css({"padding-left":parseInt(d)+g+"px","padding-right":parseInt(e)+g+"px"})})}},Init:function(){var a=this,b=$("#J_ZldList");a.Resize(),$(document).on("click","#J_ZldList .add",function(){User.CheckLogin()&&a.Create()}),$(document).on("click",".K_link_it .nm",function(){if(Zld.IsSortable)Zld.IsSortable=!1;else{var b=$(this).closest("li"),c=b.data("url");a.Go(c)}return!1}),$(document).on("click",".cs-btn",function(){if(User.CheckLogin()){if($(this).hasClass("add"))return!1;var b=$(this).closest("li"),c=b.data("id"),d=b.find(".nm").html(),e=b.data("url");return a.Create(c,d,e),!1}return!1}),$("#J_ZldList").sortable({items:"> li:not(.add)",start:function(a,b){$(b.item).find("span").css("cursor","move")},update:function(a,b){$(b.item).find("span").css("cursor","pointer"),Zld.IsSortable=!0,$.post(URL+"/sortArealist",{area:$(this).sortable("toArray")},function(a){})},stop:function(b,c){a.Resize(),Zld.IsSortable=!1,$(c.item).find("span").css("cursor","pointer")}}),$("#J_sortable").sortable("enable"),$(document).on("click",".radio-li",function(){$(".radio-li").removeClass("checked"),$(this).addClass("checked")}),$(document).on("click","#J_Zld .lkd-add, #J_Zld .lkd-edit",function(){var c=$("#J_Zld"),d=c.find('input[name="name"]'),e=c.find('input[name="url"]'),f=c.find('input[name="id"]').val(),g=d.val(),h=e.val();return g?h?($.post(URL+"/updateArea",{web_id:f,web_url:h,web_name:g},function(d){var e=function(){var a=null;return b.find("ul>li").each(function(){return $(this).data("id")==f?(a=$(this),void 0):void 0}),a};if(1==d){var i=e();i.attr("url","/Link/index.html?mod=myarea&amp;url="+h),i.data("url",h),i.find("b").html(g)}else if(d>1){var i=b.find(".add").closest("li");i.before(a.CreateItem(d,g,h)),a.Resize()}else-1==d?User.Login("请先登录"):alert("操作失败");c.dialog("close")}),!1):(alert("请输入网址"),e[0].focus(),!1):(alert("请输入网站名称"),d[0].focus(),!1)}),$(document).on("click","#J_Zld .lkd-del, .link-remove, .zld-remove-btn",function(){if($("#J_Zld").size())var b=$("#J_Zld"),c=b.find('input[name="id"]').val();else var b=$(this).closest("li"),c=b.data("id");return $.post(URL+"/delArea",{web_id:c},function(d){var e=function(){var a=null;return $(".K_link_it").each(function(b,d){return $(d).data("id")==c?(a=$(d),void 0):void 0}),a};if(1==d){var f=e();f.remove(),a.Resize(),b.dialog("close")}else-1==d?User.Login("请先登录"):alert("操作失败")}),!1})},Go:function(a){var b=$("#J_MyAreaForm");b.find('input[name="url"]').val(a),b.submit()},Create:function(a,b,c){var d=$("#J_Zld");d.dialog({autoOpen:!1,modal:!0,resizable:!1,width:440,show:{effect:"clip",duration:150},hide:{effect:"clip",duration:150},open:function(){setTimeout(function(){d.find('input[name="name"]').select()},20)}}),d.find(".close-btn").on("click",function(){return d.dialog("close"),!1}),d.find('input[name="name"],input[name="url"]').on("mouseover",function(){$(this).focus().select()}),d.find('input[name="name"],input[name="url"]').on("keydown",function(a){if(13==a.keyCode){if(self.etimestamp){if(self.etimestamp==a.timeStamp)return!1;self.etimestamp=a.timeStamp}else self.etimestamp=a.timeStamp;return d.find(".lkd-add").trigger("click"),!1}}),a?(d.find('input[name="id"]').val(a),d.find('input[name="name"]').val(b),d.find('input[name="url"]').val(c),d.find(".zld-remove-btn").show()):(d.find(".zld-remove-btn").hide(),d.find('input[name="id"]').val(""),d.find('input[name="name"]').val(""),d.find('input[name="url"]').val("")),d.dialog("open")},CreateItem:function(a,b,c){var d='<li class="K_link_it" id="'+a+'" url="/Link/index.html?mod=myarea&amp;url='+c+'" data-id="'+a+'" data-url="'+c+'">';return d=d+'<b class="nm">'+b+'</b><span class="cs-btn"></span>',d+="</li>"}},HelpMouse={Init:function(){var a=this,b=!1,c=0;$(document).on("mousemove","#direct_text",function(){return $("#direct_text").val()==$("#direct_text").attr("txt")&&($("#direct_text").select().removeClass("ipton"),b=!1,""==$.trim($("#search_text").val())&&$("#J_thl_div").hide()),!1}),$(document).on("mouseenter",".top-nav-inner",function(){0==c&&(c=1)}).on("mouseleave",".top-nav-inner",function(){c=0}).on("mousemove","#direct_text, #J_direct_submit",function(){c=2}),$(document).on("mousemove",function(d){var e=1;if($(".links123-app-frame").each(function(){$(this).is(":visible")&&(e?e=0:"")}),!e)return!1;var f=a.getcoords(d),g=$("#search_text"),h=$("#direct_text"),i=g.offset().left-10;g.offset().top+g.height(),i+g.width(),h.offset().left+h.width()+10;var j=$(".header"),k=j.offset().top+j.height(),l=$(".zld"),m=l.offset().top+l.height();if(!($(window).scrollTop()>800)){if(1==c)return $("#direct_text").val()==$("#direct_text").attr("txt")&&($("#direct_text").select().removeClass("ipton"),b=!1,""==$.trim($("#search_text").val())&&$("#J_thl_div").hide()),void 0;if(f.y<k&&f.x<i&&$("#direct_text").val()==$("#direct_text").attr("txt")&&($("#direct_text").select().removeClass("ipton"),b=!1,""==$.trim($("#search_text").val())&&$("#J_thl_div").hide()),f.y<k&&f.x>i&&$("#J_thl_div").is(":hidden")&&"true"==$("#J_thl_div").attr("data-hide")&&$("#J_thl_div").attr("data-hide","false").show(),f.y>k&&f.y<m||f.x>i){if($("#direct_text").val($("#direct_text").attr("txt")).addClass("ipton"),$("#J_thl_div").is(":hidden")&&"true"==$("#J_thl_div").attr("data-hide"))return;b||($("#search_text").select().trigger("mouseenter"),b=!0)}f.y>m&&$("#J_thl_div").attr("data-hide","true").hide()}})},getcoords:function(a){return a.pageX||a.pageY?{x:a.pageX,y:a.pageY}:{x:a.clientX+document.body.scrollLeft-document.body.clientLeft,y:a.clientY+document.body.scrollTop}}};$(function(){$.fn.links123_apptrigers=function(a){this.on("click",a,function(){var a=$(this).data("href");$(this).data("links_app")||$(this).data("links_app",new App(a));var b=$(this).data("links_app");return b.show(),!1})},$("#J_Apps").links123_apptrigers(".J_app_trig"),$("#J_Apps").on("click",".J_app_link",function(){window.open($(this).data("href"))}),$("#J_Apps").sortable({update:function(){$.post(URL+"/sortApp",{appIds:$(this).sortable("toArray")},function(a){})}}),$("#J_Apps").sortable("enable");var apps=[],App=function(a){this.appId=a,this.$elem=$(a),this.$elem.addClass("links123-app-frame"),this.initStyle(),this.bindEvent(),apps.push(this),callbacks[a]&&callbacks[a](this)};App.prototype={show:function(){var a=this;this.$elem.fadeIn(function(){"#J_box_translate"==a.appId&&setTimeout(function(){$(".J_translate_source").select()},0)})},close:function(){this.$elem.fadeOut()},initStyle:function(){this.w=this.$elem.outerWidth();var a=this.$elem.outerHeight(),b=parseInt(a)<parseInt($(window).height())?{"margin-left":-this.w/2,"margin-top":-a/2+parseInt($("#J_header").outerHeight())}:{"margin-left":-this.w/2,"margin-top":0,top:parseInt($("#header").outerHeight())+10};this.$elem.css(b),$(window).height()},bindEvent:function(){var a=this;0==a.$elem.children(".links123-close-wrap").length&&a.$elem.prepend('<div class="links123-close-wrap"><a href="#">x</a></div>'),a.$closeBtn=a.$elem.children(".links123-close-wrap").children("a"),a.$closeBtn.bind("click",function(){a.close()}),a.$elem.bind("mousedown keydown",function(){$.map(apps,function(a){a.$elem.css("z-index","9000")}),a.$elem.css("z-index","10000")}),$(document).bind("keyup",function(b){27===b.keyCode&&a.close()})},clone:function(){var a=this.$elem.clone(),b=parseInt(this.$elem.offset().left)-parseInt(this.$elem[0].style.marginLeft)+20,c=parseInt(this.$elem.offset().top)-parseInt(this.$elem[0].style.marginTop)+20;return a.attr("id",Math.random().toString().substring(3)),a.css({left:b,top:c}),$("body").append(a),new App("#"+a.attr("id"))},sync:function(){$.post("",this.data,function(){},"json")},enableDrag:function(a){var b=this,c=this.$elem.find(a),d=function(c){var d=parseInt(c.clientX),f=parseInt(c.clientY),g=parseInt(b.$elem[0].style.marginLeft),h=parseInt(b.$elem[0].style.marginTop),i=d-b._x-g,j=f-b._y-h,k=$("#J_header").outerHeight();".music_icon"==a&&(b.$elem.css("bottom","auto"),i-=$(window).scrollLeft(),j-=$(window).scrollTop()),k>=j+h&&(j=k-h),i>=$(window).width()+g&&(i=$(window)-g/2),b.$elem.css({left:i,top:j}),$(document).bind("mouseup",e)},e=function(){$(document).unbind("mousemove",d),b.$elem.removeClass("K_box_music_move")};c.css("cursor","move"),c.bind("mousedown",function(c){b._x=parseInt(c.clientX)-parseInt(b.$elem.offset().left),b._y=parseInt(c.clientY)-parseInt(b.$elem.offset().top),".music_icon"==a&&b.$elem.addClass("K_box_music_move"),$(document).bind("mousemove",d),$(document).bind("mouseup",e)}),c.bind("mouseup",e)}};var callbacks={"#J_box_note":function(a){function b(){$.cookies.set("links123_note_bg",f)}function c(){setTimeout(function(){e.focus()},100),e.css("background",$.cookies.get("links123_note_bg"))}var d=a.$elem,e=d.find("textarea"),f=null,g=a;g.enableDrag(".box_note_header"),c(),d.on("click","[class^=color_]",function(){f=""+$(this).css("background-color"),e.css("background",f),b()}),d.on("click",".btn_add",function(){var a=g.clone();callbacks["#J_box_note"](a),a.$elem.find("textarea").val(""),a.$elem.find("textarea").css("background","#fff")}),d.on("click",".btn_clear",function(){e.val(""),b()})},"#J_box_mail":function(){var a={MailConfig:[{action:"https://ssl.mail.163.com/entry/coremail/fcg/ntesdoor2?df=mail163_letter&from=web&funcid=loginone&iframe=1&language=-1&net=t&passtype=1&product=mail163&race=382_92_196_gz&style=-1",name:"@163.com",params:{username:"#{u}",password:"#{p}",savelogin:"0",url2:"http://mail.163.com/errorpage/err_163.htm"}},{action:"https://ssl.mail.126.com/entry/cgi/ntesdoor?hid=10010102&funcid=loginone&df=mail126_letter&language=-1&passtype=1&verifycookie=-1&iframe=1&from=web&net=failed&product=mail126&style=-1&race=-2_-2_-2_db",name:"@126.com",params:{domain:"126.com",username:"#{u}@126.com",password:"#{p}",savelogin:"0",url2:"http://mail.126.com/errorpage/err_126.htm"}},{action:"https://login.sina.com.cn/sso/login.php",name:"@sina.com",params:{username:"#{u}@sina.com",password:"#{p}",entry:"freemail",gateway:"0",encoding:"UTF-8",url:"http://mail.sina.com.cn/",returntype:"META"}},{action:"https://edit.bjs.yahoo.com/config/login",name:"@yahoo.com.cn",params:{login:"#{u}@yahoo.com.cn",passwd:"#{p}",domainss:"yahoo",".intl":"cn",".src":"ym"}},{action:"https://login.sina.com.cn/sso/login.php",name:"@sina.cn",params:{username:"#{u}@sina.cn",password:"#{p}",entry:"freemail",gateway:"0",encoding:"UTF-8",url:"http://mail.sina.com.cn/",returntype:"META"}},{action:"http://passport.sohu.com/login.jsp",name:"@sohu.com",params:{loginid:"#{u}@sohu.com",passwd:"#{p}",fl:"1",vr:"1|1",appid:"1113",ru:"http://login.mail.sohu.com/servlet/LoginServlet",ct:"1173080990",sg:"5082635c77272088ae7241ccdf7cf062"}},{action:"https://mail.yeah.net/entry/cgi/ntesdoor?df=webmailyeah&from=web&funcid=loginone&iframe=1&language=-1&passtype=1&verifycookie=1&product=mailyeah&style=-1&",name:"@yeah.net",params:{domain:"yeah.net",username:"#{u}@yeah.net",user:"#{u}",password:"#{p}",savelogin:"0",url2:"http://mail.yeah.net/errorpage/err_yeah.htm"}},{action:"https://mail.10086.cn/Login/Login.ashx?_fv=5&cguid=1144153566504&_=3900d6b56d0742590535b3bb5ddee9f923b4326c ",name:"@139.com",params:{UserName:"#{u}",Password:"#{p}"}},{action:"http://passport.21cn.com/maillogin.jsp",name:"@21cn.com",params:{UserName:"#{u}@21cn.com",passwd:"#{p}",domainname:"21cn.com"}},{action:"http://mail.qq.com",type:"link"},{action:"http://gmail.google.com",type:"link"},{action:"http://www.hotmail.com",type:"link"},{action:"https://passport.alipay.com/login/login.htm?fromSite=9&return_url=http%3A%2F%2Fmail.aliyun.com%2Funiquelogin.htm",type:"link"},{action:"https://login.yahoo.com/config/login_verify2?&.src=ym&.intl=us",type:"link"},{action:"http://mail.links123.cn",type:"link"}]},b={mailCache:[],sendMail:function(){var b=$.trim($("#mailUserName").val()),c=$.trim($("#mailPassWord").val());if(""==b)return alert("用户名不能为空！"),!1;if(""==c)return alert("密码不能为空！"),!1;var d=$("#J_mailForm"),e=$("#mail_list").attr("selectindex"),f=a.MailConfig[e];if(0==f.val)return alert("您没有选择邮箱！"),void 0;d.attr("action",f.action);var g="";for(param in f.params)g='<input type="hidden" class="J_mail_form_hidden" name="'+param+'" value="'+f.params[param].replace("#{u}",b).replace("#{p}",c)+'" />',d.append(g);d.submit(),$(".J_mail_form_hidden").remove(),$("#mailPassWord").value=""},change:function(b){var c=a.MailConfig[b];if("link"==c.type){$("#mailSelect").text(a.MailConfig[0].name),$("#mail_list").attr("selectindex",0);var d=$("#J_mailForm");d.attr("action",c.action);var e="";for(param in c.params)e='<input type="hidden" class="J_mail_form_hidden" name="'+param+'" value="'+c.params[param].replace("#{u}",mailUserName).replace("#{p}",mailPassWord)+'" />',d.append(e);d.append(e),d.submit(),$(".J_mail_form_hidden").remove(),$("#mailPassWord").value=""}else $("#mailSelect").text(a.MailConfig[b].name),$("#mail_list").attr("selectindex",b)}};$("#J_box_mail").mouseover(function(){return $("#mailUserName").select(),!1}),$("#mailPassWord").mouseover(function(){return $("#mailPassWord").select(),!1}),$("#J_mail_submit").click(function(){return b.sendMail(),!1}),$("#mailPassWord").keypress(function(a){return 13==a.keyCode?(b.sendMail(),!1):void 0}),$(".mail-list li").click(function(){b.change($(this).attr("dn")),$("#mailUserName").select()}),$(".mail-list li").mouseover(function(){$(this).addClass("option-hover")}),$(".mail-list li").mouseout(function(){$(this).removeClass("option-hover")})},"#J_box_calendar":function(){$("#J_calendar_iframe").attr("src","http://baidu365.duapp.com/wnl.html"),$("#J_box_calendar_list a").click(function(){return $("#J_calendar_iframe").attr("src",$(this).attr("data-url")),!1})},"#J_box_calc":function(){$("#J_calc_iframe").attr("src","http://qiqiapp3.duapp.com/yuyinjisuanqi/"),$("#J_box_calc_list a").click(function(){return $("#J_calc_iframe").attr("src",$(this).attr("data-url")),!1})},"#J_box_translate":function(){var translateLang=0,lns={"group-1":[["sq","阿尔巴尼亚语"],["ar","阿拉伯语"],["az","阿塞拜疆语"],["ga","爱尔兰语"],["et","爱沙尼亚语"],["eu","巴斯克语"],["be","白俄罗斯语"],["bg","保加利亚语"],["is","冰岛语"],["pl","波兰语"]],"group-2":[["bs","波斯尼亚语"],["fa","波斯语"],["af","布尔语(南非荷兰语)"],["da","丹麦语"],["de","德语"],["ru","俄语"],["fr","法语"],["tl","菲律宾语"],["fi","芬兰语"],["km","高棉语"],["ka","格鲁吉亚语"]],"group-3":[["gu","古吉拉特语"],["ht","海地克里奥尔语"],["ko","韩语"],["nl","荷兰语"],["gl","加利西亚语"],["ca","加泰罗尼亚语"],["cs","捷克语"],["kn","卡纳达语"],["hr","克罗地亚语"],["la","拉丁语"],["lv","拉脱维亚语"]],"group-4":[["lo","老挝语"],["lt","立陶宛语"],["ro","罗马尼亚语"],["mt","马耳他语"],["mr","马拉地语"],["ms","马来语"],["mk","马其顿语"],["bn","孟加拉语"],["hmn","苗语"],["no","挪威语"],["pt","葡萄牙语"]],"group-5":[["ja","日语"],["sv","瑞典语"],["sr","塞尔维亚语"],["eo","世界语"],["sk","斯洛伐克语"],["sl","斯洛文尼亚语"],["sw","斯瓦希里语"],["ceb","宿务语"],["te","泰卢固语"],["ta","泰米尔语"],["th","泰语"]],"group-6":[["tr","土耳其语"],["cy","威尔士语"],["ur","乌尔都语"],["uk","乌克兰语"],["iw","希伯来语"],["el","希腊语"],["es","西班牙语"],["hu","匈牙利语"],["hy","亚美尼亚语"],["it","意大利语"],["yi","意第绪语"]],"group-7":[["hi","印地语"],["id","印尼语"],["jw","印尼爪哇语"],["vi","越南语"],["zh-TW","中文(繁体)"],["zh-CN","中文(简体)"],["en","英语"]]},totalHTML="",groupHTML,curClass;$.each(lns,function(a,b){groupHTML="group-1"==a?'<div class="goog-menuitem goog-option goog-option-selected goog-menuitem-highlight J_lang_auto"aria-selected="true" style="-moz-user-select: none;" data-id="auto" id=":2"><div class="goog-menuitem-content"><div class="goog-menuitem-checkbox"></div>检测语言</div></div><div class="goog-menuseparator" role="separator" style="-moz-user-select: none;" id=":3"></div>':"",$.each(b,function(a,b){curClass="en"==b[0]?"goog-menuitem-emphasize-highlight":"",("zh-CN"==b[0]||"en"==b[0])&&(b[1]="<b>"+b[1]+"</b>"),groupHTML+='<div class="goog-menuitem goog-option '+curClass+'" style="-moz-user-select: none;" data-id="'+b[0]+'"><div class="goog-menuitem-content"><div class="goog-menuitem-checkbox"></div>'+b[1]+"</div></div>"}),groupHTML='<td><div id="goog-menuitem-'+a+'" class="goog-menuitem-group" style="width: 100%;">'+groupHTML+"</div></td>",totalHTML+=groupHTML}),$("#gt-sl-gms-menu").find("tr").html(totalHTML),$(".J_translate_clear").click(function(){return $("#gt-res-dict").html(""),$("#result_box").html(""),$(".J_translate_source").val(""),$(".J_translate_source").select(),!1}),$("#gt-sl-gms").click(function(){return translateLang=0,$(this).hasClass("goog-flat-menu-button-focused")?($(this).removeClass("goog-flat-menu-button-focused"),$("#gt-sl-gms-menu").hide()):($("#gt-tl-gms").removeClass("goog-flat-menu-button-focused"),$(this).addClass("goog-flat-menu-button-focused"),$(".J_lang_auto").show(),$("#gt-sl-gms-menu").show()),!1}),$("#gt-tl-gms").click(function(){return translateLang=1,$(this).hasClass("goog-flat-menu-button-focused")?($(this).removeClass("goog-flat-menu-button-focused"),$("#gt-sl-gms-menu").hide()):($("#gt-sl-gms").removeClass("goog-flat-menu-button-focused"),$(this).addClass("goog-flat-menu-button-focused"),$(".J_lang_auto").hide(),$("#gt-sl-gms-menu").show()),!1}),$(".goog-menuitem").mouseover(function(){$(".goog-menuitem").removeClass("goog-menuitem-highlight"),$(this).addClass("goog-menuitem-highlight")}),$(".goog-menuitem").click(function(){var a=$.trim($(this).text()),b=$(this).attr("data-id");return 1==translateLang?($("#J_lang_tgt").text(a),$("#gt-tl-gms").removeClass("goog-flat-menu-button-focused"),$("#gt-tl").val(b)):($("#J_lang_src").text(a),$("#gt-sl-gms").removeClass("goog-flat-menu-button-focused"),$("#gt-sl").val(b)),$("#gt-sl-gms-menu").hide(),$("#gt-submit").trigger("click"),!1}),$("#gt-swap").click(function(){var a=$.trim($("#J_lang_src").text()),b=$.trim($("#J_lang_tgt").text()),c=$("#gt-sl").val(),d=$("#gt-tl").val();return $("#J_lang_tgt").text(a),$("#gt-tl").val(c),$("#J_lang_src").text(b),$("#gt-sl").val(d),$("#gt-submit").trigger("click"),!1}),$("#gt-submit").click(function(){var sl=$("#gt-sl").val(),tl=$("#gt-tl").val(),q=$(".J_translate_source").val();$("#gt-res-dict").html('<tr><td colspan="4"><div class="gt-baf-cell gt-baf-pos">翻译中...</div></td></tr>'),$("#result_box").html(""),$.ajax({type:"POST",url:APP+"Index/google_translate",data:{sl:sl,tl:tl,q:q},cache:!1,dataType:"json",success:function(data){var dictArr=eval(data.data);if(dictArr){var dictStr="";dictStr+='<table class="gt-baf-table"><tbody>';var dictSubArr="",dictType=0;if("undefined"!=typeof dictArr[1]?dictSubArr=dictArr[1]:"undefined"!=typeof dictArr[0]&&(dictSubArr=dictArr[0],dictType=1),dictSubArr){if(dictType){dictStr+='<span lang="zh-CN" id="result_box">';for(var i=0;i<dictSubArr.length;i++){var bafArr=dictSubArr[i];dictStr+="<span>"+bafArr[0].replace("\n","</br>")+"</span>"}dictStr+="</span>"}else for(var i=0;i<dictSubArr.length;i++){var bafArr=dictSubArr[i];if(dictStr+='<tr><td colspan="4"><div class="gt-baf-cell gt-baf-pos">'+bafArr[0]+"</div></td></tr>",bafArr[2]instanceof Array)for(var j=0;j<bafArr[2].length;j++){dictStr+="<tr>";
var wordArr=bafArr[2][j];dictStr+="<td>";var cts_width=24;wordArr[3]<.01?cts_width=8:wordArr[3]<.1&&(cts_width=16),dictStr+='<div class="gt-baf-cell gt-baf-marker-container"><div class="gt-baf-cts" style="width:'+cts_width+'px;"></div></div>',dictStr+="</td>",dictStr+='<td><div class="gt-baf-cell gt-baf-bar"></div></td>',dictStr+="<td>",dictStr+='<div class="gt-baf-cell gt-baf-word-clickable" style="text-align: left; direction: ltr;">'+wordArr[0]+"</div>",dictStr+="</td>",dictStr+='<td style="width: 100%;">',dictStr+='<div class="gt-baf-cell gt-baf-translations" style="direction: ltr;">';for(var k=0;k<wordArr[1].length;k++)dictStr+='<span class="gt-baf-back">'+wordArr[1][k],k!=wordArr[1].length-1&&(dictStr+=", "),dictStr+="</span>";dictStr+="</div>",dictStr+="</td>",dictStr+="</tr>"}}dictStr+="</tbody></table>",$("#gt-res-dict").html(dictStr)}else $("#gt-res-dict").html("");dictType||$("#result_box").html(dictArr[0][0][0])}else $("#result_box").html('<span style="font-size:14px; color: red;">亲，未找到你所查询的结果，再试下吧!</span>')},error:function(){}})})},"#J_box_weather":function(){if($.browser.safari&&null==navigator.userAgent.toLowerCase().match(/chrome/)){var a='<iframe frameborder="0" scrolling="no" src="/Home/weather/index_new.html" style="z-index: 99999; width: 380px; height: 220px; border: 0px;"></iframe>';$("#J_box_weather").find(".K_weather_box").remove().end().append(a)}},"#J_box_music":function(a){var b=detect.parse(navigator.userAgent);b.browser.isMacQQBrowser&&(a.$elem.find(".douban-source").attr("data-href","/Index/dbfm.html"),a.$elem.find(".qq-source").attr("data-href","http://soso.music.qq.com/ipad/player.html").attr("data-height","430")),a.enableDrag(".music_icon"),a.$closeBtn.unbind("click"),a.$closeBtn.bind("click",function(){$(this).hasClass("closed")?a.show():(a.$elem.css({bottom:"10px",top:"auto"}),a.close())}),a.close=function(){var b=parseInt(a.$elem.outerWidth()),c=parseInt(a.$elem.css("margin-left"));a.$elem.css({position:"fixed",left:0-b-c+5+"px"}),a.$elem.find(".music-close-wrap").hide(),a.$closeBtn.addClass("closed")},a.$elem.find(".music-close-wrap a").on("click",function(){a.$elem.fadeOut(function(){a.$elem.css({bottom:"10px",top:"auto"})}),$("#J_iframe").find("iframe").removeAttr("src")});var c=function(){var b=parseInt(a.$elem[0].style.marginLeft);"10px"==a.$elem.css("bottom")&&a.$elem.css({position:"fixed",left:0-b-3+"px"})};a.show=function(){a.$elem.find(".music-close-wrap").show(),c(),a.$elem.is(":hidden")&&(a.$elem.show(),d.children(":first-child").children("a").click()),a.$closeBtn.removeClass("closed")};var d=$("#J_with_submenu").find(".submenu"),e=$("#J_with_submenu").children("a").children(".J_root_menu");d.on("click","a",function(){$(this).parent().siblings().removeClass("hide last"),$(this).parent().addClass("hide").removeClass("last"),e.html($(this).html());var a=d.children("[class!=hide]");$(a[a.length-1]).addClass("last"),g($(this))});var f=function(a){$("#J_box_music").css({"margin-left":"-"+a.data("width")/2+"px","margin-top":"-"+a.data("height")/2+"px"}),$("#J_music_iframe_wrap").css({width:a.data("width"),height:a.data("height")})},g=function(a){!a.hasClass("qq-source")||"Firefox"!=b.browser.family&&"IE"!=b.browser.family?$("#K_qq_music_browser_tip").hide():$("#K_qq_music_browser_tip").show();var d='<iframe scrolling="no" height="'+a.data("height")+'" width="'+a.data("width")+'" frameborder="0" style="overflow:hidden" allowtransparency="true" src="'+a.data("href")+'"></iframe>';f(a),$("#J_iframe").html(d),c()};d.children(":first-child").children("a").click(),a.close(),a.$elem.fadeIn()}}}),function(){var a={};a.CHS_WEEKS=["一","二","三","四","五","六","日"],a.CHS_MONTHS=["一","二","三","四","五","六","七","八","九","十","十一","十二"],a.ENG_WEEKS=["MON","TUE","WED","THU","FRI","SAT","SUN"],a.ENG_MONTHS=["January","February","March","April","May","June","July","Auguest","September","October","November","December"],Date.prototype.add=function(a){return new Date(1*this+864e5*a)};var b=function(a){var b,c,d=function(){this.init.apply(this,arguments)};return d.prototype.init=function(){},a&&(c=function(){},c.prototype=a.prototype,d.uber=a.prototype,d.prototype=new c),d.extend=function(a){for(b in a)d[b]=a[b]},d.include=function(a){for(b in a)d.prototype[b]=a[b],d.uber&&"function"==typeof d.uber[b]&&(a[b].spfunc=d.uber[b])},d.prototype._super=function(){arguments.callee.caller.spfunc.apply(this,arguments)},d},c={Init:function(a){var b=this;b.type=a||"Date",b.weekStart=1,b.marksStore={},b.timer=null;var c=b.today=Date.today();b.tooltip=$('<div class="calendar-tip"><div class="content"></div><span class="ang"></span></div>'),b.ajaxOverlayer=$(".cal-ajax-overlayer"),b.setCurrentDate(c),$(".cal-header-date-prev").on("click",function(){b.prevView()}),$(".cal-header-date-next").on("click",function(){b.nextView()}),$(".cal-view-select-btn").on("click",function(){$(".cal-view-select-btn").removeClass("active");var a=$(this).attr("data-type");b.changeType(a)}),$(".cal-body").on("mouseover",".cal-month td",function(){var a=$(this),c=a.find("a").attr("data-date");if(b.marksStore[b.currentMarkId]&&b.marksStore[b.currentMarkId][c]){var d=b.marksStore[b.currentMarkId][c],e="";$.each(d,function(a,b){e+="<p>"+b.desc+"</p>"}),b.tooltip.find(".content").html(e).end().appendTo(a).show()}}).on("mouseout",".cal-month td",function(){b.tooltip.hide()}),b.DateView.Init(),b.MonthView.Init(),b.WeekView.Init(),b.DateView.miniMonthView.render(),b.DateView.mainPanel.show(),b.loadMarks()},showDate:function(){var a=this,b=a.type,c=a.currentDate,d=a.currentMonth,e=a.currentYear;if("Date"==b&&(a.date_text=e+"年"+(d+1)+"月"+c+"日"),"Week"==b){var f=a.currentWeekStartObject,g=a.currentWeekEndObject,h=f.getFullYear(),i=f.getMonth()+1,j=f.getDate(),k=g.getFullYear(),l=g.getMonth()+1,m=g.getDate(),n=k==h?"":k+"年";if(""!=n||l!=i)var o=l+"月";else var o="";a.date_text=h+"年"+i+"月"+j+"日 - "+n+o+m+"日"}"Month"==b&&(a.date_text=e+"年"+(d+1)+"月"),$(".cal-header-date").html(a.date_text)},changeType:function(a){this.type=a,$(".cal-view-select-btn").removeClass("active"),$(".cal-view-select-btn-"+a.toLowerCase()).addClass("active"),this.showDate(),this.DateView.mainPanel.hide(),this.WeekView.mainPanel.hide(),this.MonthView.mainPanel.hide();var b=this[a+"View"];b.mainPanel.show(),"Date"==a&&c.DateView.miniMonthView.render(),"Month"==a&&c.MonthView.tableView.render(),b.renderMarks()},prevView:function(){this[this.type+"PrevView"]()},nextView:function(){this[this.type+"NextView"]()},DateChangeFunc:function(a){var b=this,c=new Date(b.currentYear,b.currentMonth,a);b.setCurrentDate(c),b.DateView.miniMonthView.render(),b.marksStore[b.currentMarkId]?b.DateView.renderMarks():b.loadMarks()},DatePrevView:function(){this.DateChangeFunc(this.currentDate-1)},DateNextView:function(){this.DateChangeFunc(this.currentDate+1)},WeekChangeFunc:function(a){var b=this,c=new Date(b.currentYear,b.currentMonth,a);b.setCurrentDate(c);var d=b.currentWeekStartObject.getFullYear()+"-"+b.currentWeekStartObject.getMonth(),e=b.currentWeekEndObject.getFullYear()+"-"+b.currentWeekEndObject.getMonth();b.marksStore[d]&&b.marksStore[e]?b.WeekView.renderMarks():b.loadMarks()},WeekPrevView:function(){this.WeekChangeFunc(this.currentWeekStart-7)},WeekNextView:function(){this.WeekChangeFunc(this.currentWeekStart+7)},MonthChangeFunc:function(a){var b=this,c=new Date(b.currentYear,a,1);b.setCurrentDate(c),b.MonthView.tableView.render(),b.marksStore[b.currentMarkId]?b.MonthView.renderMarks():b.loadMarks()},MonthPrevView:function(){this.MonthChangeFunc(this.currentMonth-1)},MonthNextView:function(){this.MonthChangeFunc(this.currentMonth+1)},request:function(a){var b={type:"GET",dataType:"json"};a=$.extend(b,a);var c=$.Deferred(),d=$.ajax(a).done(function(a){1===a.status?c.resolveWith(d,[a.data]):c.rejectWith(d,[a.status,a.info])}).fail(function(a){200==a.status?c.rejectWith(d,[a.status,"JSON解析失败"]):c.rejectWith(d,[a.status,a.statusText])});return c.promise()},howManyDaysInMonth:function(a,b){var c=[31,28,31,30,31,30,31,31,30,31,30,31];return(1==b&&0==a%40&&0!=a%100||0==a%400)&&(c[1]=29),c[b]},posInYear:function(a,b,c){for(var d=1;b>d;++d)c+=howManyDaysInMonth(a,d);return c},compare:function(a,b){return a.getFullYear()<b.getFullYear?-1:a.getFullYear()>b.getFullYear()?1:a.getMonth()<b.getMonth()?-1:a.getMonth()>b.getMonth()?1:a.getDate()<b.getDate()?-1:a.getDate()>b.getDate()?1:0},posInWeek:function(a,b,c){return new Date(a,b,c).getDay()},setCurrentDate:function(a){var b=this;b.currentDateObject=a,b.currentDate=a.getDate(),b.currentMonth=a.getMonth(),b.currentYear=a.getFullYear(),b.currentWeekStart=a.getDate()-(a.getDay()-c.weekStart),b.currentWeekEnd=b.currentWeekStart+6,b.currentWeekStartObject=new Date(b.currentYear,b.currentMonth,b.currentWeekStart),b.currentWeekEndObject=new Date(b.currentYear,b.currentMonth,b.currentWeekEnd),b.currentMarkId=b.currentYear+"-"+b.currentMonth,b.showDate()},loadMarks:function(){var a=this,b=a.currentYear,c=a.currentMonth;if("Week"==a.type)var d=a.currentWeekStartObject.getFullYear(),e=a.currentWeekStartObject.getMonth(),f=a.currentWeekEndObject.getFullYear(),g=a.currentWeekEndObject.getMonth();if("Week"==a.type&&d!=f||e!=g){var h=a.request({url:PUBLIC+"/IndexV4/src/json/"+d+"/"+(e+1)+".json"}),i=a.request({url:PUBLIC+"/IndexV4/src/json/"+f+"/"+(g+1)+".json"});$.when(h,i).fail(function(){a[a.type+"View"].renderMarks()}).done(function(b,c){a.ajaxOverlayer.hide(),b=null===b?[]:b,c=null===c?[]:c,a.marksStore[d+"-"+e]=b,a.marksStore[f+"-"+g]=c,a[a.type+"View"].renderMarks()})}else a.request({url:PUBLIC+"/IndexV4/src/json/"+b+"/"+(c+1)+".json"}).fail(function(){a[a.type+"View"].renderMarks()}).done(function(b){a.ajaxOverlayer.hide(),b=null===b?[]:b,a.marksStore[a.currentMarkId]=b,a[a.type+"View"].renderMarks()})}};c.DateView={Init:function(){var a=c.DateView;a.mainPanel=$(".cal-day"),a.miniMonthElement=$(".cal-mini-month-panel").find("tbody"),a.marksListElement=$(".cal-day-note-list"),a.burnDownElement=$(".cal-day-burn-down-chart"),a.burnDownChartElement=a.burnDownElement.find(".chart"),a.burnDownChartTimeElement=a.burnDownChartElement.find(".time-show"),a.miniMonthView=new e,a.miniMonthElement.on("click","a",function(){var a=$(this).attr("data-date");c.DateChangeFunc(a)}),a.burnDownElement.find(".chart-body").dblclick(function(b){var c=b.pageY-$(this).offset().top;c-=c%3;var d=+Date.today()+1e3*60*15*(c/3),e=new g({time:d/1e3,desc:""});e.appendTo($(this));var f=a.burnDownChartElement.offset().top+a.burnDownChartElement.height();e.html.offset().top+e.html.height()<=f&&e.html.addClass("cal-day-event-item-pass"),e.html.find(".desc").trigger("dblclick")})},renderBurnDownChart:function(){clearTimeout(c.timer);var a=this,b=c.compare(c.currentDateObject,Date.today());if(0!=b)a.burnDownChartTimeElement.hide(),0>b?(a.burnDownChartElement.height(a.burnDownElement.height()).show(),a.burnDownElement.find(".cal-day-event-item").addClass("cal-day-event-item-pass")):a.burnDownChartElement.hide();else{var d=new Date,e=d-Date.today(),f=86400/a.burnDownElement.find(".chart-body").height(),g=e/1e3/f+39;a.burnDownChartElement.height(g).show(),a.burnDownChartTimeElement.html(d.toString("HH:mm")).show();var h=a.burnDownChartElement.offset().top+a.burnDownChartElement.height();a.burnDownElement.find(".cal-day-event-item").each(function(){$(this).offset().top+$(this).height()<=h&&$(this).addClass("cal-day-event-item-pass")}),c.timer=setTimeout(function(){c.DateView.renderBurnDownChart()},3e4)}},renderMarks:function(){var a=this,b=c.marksStore[c.currentYear+"-"+c.currentMonth];if(b&&b[c.currentDate])var d=a.marks=b[c.currentDate];else var d=a.marks=[];var e="",f=0,h=a.burnDownElement.find(".chart-body");h.empty(),$.each(d,function(a,b){e+="<li>"+a+" : "+b.desc+"</li>",f++;var c=new g(b);c.appendTo(h)}),a.marksListElement.find(".cal-day-ul").html(e),a.marksListElement.find(".marks-count").html(f),a.renderBurnDownChart()}},c.MonthView={Init:function(){var a=this;a.mainPanel=$(".cal-month"),a.tableElement=a.mainPanel.find("table"),a.tableView=new f,a.tableElement.on("click","a",function(){var a=c.currentYear,b=c.currentMonth,d=$(this).attr("data-date");d=new Date(a,b,d),c.setCurrentDate(d),c.changeType("Date")})},renderBurnDownChart:function(){var a=this,b=c.currentYear,d=c.currentMonth,e=c.today.getDate();b<=c.today.getFullYear()&&d<c.today.getMonth()?a.tableElement.find("td").addClass("month_pass_date"):b==c.today.getFullYear()&&d==c.today.getMonth()&&a.tableElement.find("td").each(function(b,c){var d=$(c).find("a").attr("data-date");-1!=d&&e>d?$(c).addClass("month_pass_date"):d==e&&(a.todayElement=$(c))})},renderMarks:function(){var a=this,b=c.marksStore[c.currentYear+"-"+c.currentMonth];a.marks=b?b:b={},$.each(b,function(b,c){var d=a.tableElement.find(".td_"+b).parent("td");$.each(c,function(a){var b=7*parseInt(a/7)+5,c=7*(a%7)+5;b="top:"+b+"px;",c="left:"+c+"px;";var e=b+c;d.append('<b class="month_task_dot" style="'+e+'"></b>')})}),a.renderBurnDownChart()}},c.WeekView={Init:function(){var a=this;a.mainPanel=$(".cal-week"),a.tableElement=a.mainPanel.find("table"),a.tableElement.on("click","td",function(){var a=$(this).attr("data-year"),b=$(this).attr("data-month"),d=$(this).attr("data-date");c.setCurrentDate(new Date(a,b,d)),c.changeType("Date")})},renderBurnDownChart:function(){clearTimeout(c.timer);var a=this;c.currentWeekStartObject;var b=c.today;a.burnDownChartElement=$('<div class="chart"><h5 class="time-show">00:00</h5></div>');var d=b.getDay()-c.weekStart,e=a.tableElement.find("td:eq("+d+")");a.burnDownChartElement.appendTo(e);var f=new Date,g=f-c.today,h=86400/e.height()-6,i=g/1e3/h-6;a.burnDownChartElement.height(i).show(),a.burnDownChartElement.find(".time-show").html(f.toString("HH:mm"));var j=a.burnDownChartElement.offset().top+a.burnDownChartElement.height();e.find(".week-mark-line").each(function(){$(this).offset().top+$(this).height()<=j&&$(this).addClass("week-mark-line-pass")}),c.timer=setTimeout(function(){c.DateView.renderBurnDownChart()},3e4)},renderMarks:function(){var a=this,b=c.currentWeekStartObject;c.currentWeekEndObject;var d,e,f,g,h,i,j,k,l,m,n,o,p,q=c.today;a.tableElement.find("td").empty();var r=!1;for(k=0;6>=k;k++)h=b.add(k),d=h.getFullYear(),e=h.getMonth(),f=h.getDate(),g=c.marksStore[d+"-"+e]&&c.marksStore[d+"-"+e][f]?c.marksStore[d+"-"+e][f]:[],i=a.tableElement.find("td:eq("+k+")"),j=c.compare(h,q),i.removeClass("month_pass_date"),-1==j&&i.addClass("month_pass_date"),0==j&&(r=!0),$.each(g,function(a,b){l=$('<div class="week-mark-line"><b></b><span></span></div>'),m=new Date(1e3*b.time),n=b.desc,o=m.getHours(),p=m.getMinutes(),l.css("top",3*4*o+3*(p/15)),i.attr({"data-date":f,"data-month":e,"data-year":d}).append(l)});r&&a.renderBurnDownChart()}};var d=new b;d.include({init:function(){this.weekStart=c.weekStart,this.year=null,this.month=null},initBaseArray:function(a,b){var d=this;d.year=a,d.month=b;var e,f=d.weekStart,g=c.howManyDaysInMonth(a,b),h=c.posInWeek(a,b,1),i=[];for(e=1;g>=e;e++)i.push(e);for(e=1,g=h-f;g>=e;e++)i.unshift(0);if(g=i.length%7,0==!g)for(g=7-g,e=1;g>=e;e++)i.push(-1);d.baseArray=i},buildTable:function(){var a=this;(a.year!==c.currentYear||a.month!==c.currentMonth)&&a.initBaseArray(c.currentYear,c.currentMonth);for(var b,d=a.baseArray,e="",f=0,g=d.length;g>f;f++)b=d[f],b=0==b||-1==b?'<td><a data-date="'+b+'" style="display:none"></a></td>':'<td><a class="td_'+b+'" href="javascript:;" data-date="'+b+'">'+b+"</a></td>",0==(f+1)%7&&(b+="</tr>"),0==f%7&&(b="<tr>"+b),e+=b;return e}});var e=new b(d);e.include({render:function(a){var b=this;a=a||c.DateView.miniMonthElement;var d=b.buildTable();a instanceof $?a.html(d):$(a).html(d),a.find(".td_"+c.currentDate).addClass("active")}});var f=new b(d);f.include({render:function(a){var b=this;a=a||c.MonthView.tableElement.find("tbody");var d=b.buildTable();a instanceof $?a.html(d):$(a).html(d),a.find(".td_"+c.currentDate).addClass("active")}});var g=new b;g.include({init:function(a){var b=this,c=new Date(1e3*a.time),d=a.desc,e=c.getFullYear(),f=c.getMonth(),g=c.getDate(),h=c.getHours(),i=c.getMinutes();b.id=a.id,b.date=g,b.baseTime=+new Date(e,f,g,0);var j=c.toString("HH:mm"),k='<div class="cal-day-event-item"><b class="dot"></b><span class="time">'+j+"</span>"+'<span class="desc">'+d+"</span>"+'<a class="enter" href="javascript:;">确定</a>'+'<a class="del" href="javascript:;">×</a>'+"</div>";b.html=$(k).css("top",3*4*h+3*(i/15)),b.html.find(".desc").dblclick(function(){var a=$(this).html();return $(this).html('<input class="input_desc" type="text" maxlength="30" value="'+a+'" >'),b.html.find(".input_desc").select(),b.html.find(".enter").show(),!1}),b.html.find(".enter").click(function(){var a=$(this).siblings(".desc"),c=a.find(".input_desc").val();a.html(c),$(this).hide(),b.update()}),b.html.find(".del").click(function(){b.html.remove()})},update:function(){var a=this;void 0!==a.id},removeElement:function(){this.html.remove()},appendTo:function(a){var b=this;b.html.appendTo(a),b.html.draggable({axis:"y",grid:[100,3],containment:"parent",start:function(){},drag:function(a,d){var e=d.position.top,f=1e3*60*15*(e/3)+b.baseTime;f=new Date(f),f=f.getDate()!=b.date?"24:00":f.toString("HH:mm"),$(this).find(".time").html(f),baseLine=c.DateView.burnDownChartElement.offset().top+c.DateView.burnDownChartElement.height(),$(this).offset().top+$(this).height()<=baseLine?$(this).addClass("cal-day-event-item-pass"):$(this).removeClass("cal-day-event-item-pass")},stop:function(){b.update()}})}}),window.Calendar=c}(),$(function(){Calendar.Init()});var Ted={Init:function(){var a=$(".extra-ted"),b=a.find(".ted-detial-layer");a.on("mouseenter","li",function(){var a,c=$(this),d=c.index();switch(d){case 0:case 3:a="-20px";break;case 1:case 4:a="-150px";break;case 2:case 5:a="-270px"}var e=c.find(".hide-content").html(),f=c.find(".ted-img").html();b.hide().appendTo(c).find(".content").html(e).end().find(".img").html(f),b.css("left",a).fadeIn(200)}).on("mouseleave",function(){b.hide()})}};